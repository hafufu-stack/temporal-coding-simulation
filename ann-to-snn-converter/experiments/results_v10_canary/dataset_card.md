---
language:
- en
license: apache-2.0
size_categories:
- 1K<n<10K
task_categories:
- text-classification
- text-generation
tags:
- hallucination
- hallucination-detection
- self-healing
- canary-head
- attention-entropy
- ai-safety
- llm
- mistral
- synthetic
- vaccine
pretty_name: "Mistral Hallucination Vaccine: Canary-Labeled Self-Healing Dataset"
dataset_info:
  features:
  - name: type
    dtype: string
  - name: prompt
    dtype: string
  - name: response
    dtype: string
  - name: canary_entropy
    dtype: float64
  - name: correct
    dtype: bool
  - name: label
    dtype: string
  - name: question
    dtype: string
  splits:
  - name: train
    num_examples: 1002
---

# Mistral Hallucination Vaccine: Canary-Labeled Self-Healing Dataset

> ðŸ§¬ The first fully automated, canary-labeled hallucination dataset for LLMs â€” with built-in self-healing.

## Dataset Description

This dataset contains **1,002 samples** of LLM responses generated under three conditions:
1. **Clean** (334 samples): Normal Mistral-7B responses to factual questions
2. **Nightmare** (334 samples): Responses generated with hidden-state noise injection (Ïƒ=0.10), inducing hallucinations
3. **Healed** (334 samples): Self-recovered responses via Surgical Chain-of-Thought (CoT) injection after hallucination detection

Each sample is automatically labeled with **canary head entropy** â€” an attention entropy metric from a specific "canary" attention head (L10H17 in Mistral-7B) that serves as a real-time hallucination indicator.

## Key Statistics

| Label | Count | Mean Canary Entropy | Accuracy |
|-------|-------|-------------------|----------|
| Safe (clean) | 334 | ~2.6 bits | 100% |
| Hallucination (nightmare) | 334 | ~3.6 bits | 0% |
| **Recovered (healed)** | **334** | **~2.7 bits** | **97.9%** |

- **Nightmare detection rate**: 100% (334/334 detected by H > 3.0)
- **Self-healing rate**: 97.9% (327/334 successfully recovered)

## Schema

| Field | Type | Description |
|-------|------|-------------|
| `type` | string | `clean`, `nightmare`, or `healed` |
| `prompt` | string | Input prompt given to the model |
| `response` | string | Model's response text |
| `canary_entropy` | float | Entropy of canary attention head (L10H17) in bits |
| `correct` | bool | Whether the response contains the expected answer |
| `label` | string | `safe`, `hallucination`, or `recovered` |
| `question` | string | Original question text |

## Usage

```python
from datasets import load_dataset

ds = load_dataset("hafufu-stack/mistral-hallucination-vaccine")

# Filter by type
clean = ds["train"].filter(lambda x: x["type"] == "clean")
nightmares = ds["train"].filter(lambda x: x["type"] == "nightmare")
healed = ds["train"].filter(lambda x: x["type"] == "healed")

# Use canary entropy as hallucination signal
for sample in ds["train"]:
    if sample["canary_entropy"] > 3.0:
        print(f"âš ï¸ Hallucination detected: {sample['response'][:50]}")
```

## Applications

1. **Hallucination classifier training**: Use `label` field for supervised classification
2. **Canary head research**: Study `canary_entropy` distribution across conditions
3. **Self-healing method development**: Use clean/nightmare/healed triplets to develop recovery techniques
4. **DPO/RLHF training**: Use clean responses as "chosen" and nightmare responses as "rejected"

## Generation Method

- **Model**: Mistral-7B-v0.1 (Apache 2.0)
- **Canary head**: Layer 10, Head 17 (identified via ACE â€” Attention-entropy Canary Extraction)
- **Noise injection**: Gaussian noise (Ïƒ=0.10) at canary layer hidden states
- **Healing method**: Surgical Chain-of-Thought injection (" Wait, let me think about this carefully. The correct answer is:")
- **Questions**: 100 factual questions (capitals, science, math, geography, etc.), cycled to produce 334 iterations

## Related Paper

> **"Activation-Scaled ANN-to-SNN Conversion with SNN Guardrail: A Unified Framework for AI Interpretability, Hallucination Detection, Real-Time Adversarial Defense, Neural Healing, Brain State Imaging, Hallucination Anatomy, the Canary Head Paradigm, and the AI Immune System"**
>
> Funasaki, H. (2026). Zenodo preprint. DOI: 10.5281/zenodo.18457540

Part of the **AI Immune System** framework:
- **Sense**: Canary head detects perturbation (1.19Ã— sensitivity)
- **Alert**: Entropy threshold (H > 3.0) triggers alarm
- **Heal**: Surgical CoT injection recovers correct output (97.9%)
- **Learn**: This vaccine dataset encodes the full loop for downstream training

## License

Apache 2.0

Model outputs are generated by Mistral-7B-v0.1 (Apache 2.0 licensed). No restrictions on output usage or redistribution.

## Citation

```bibtex
@dataset{funasaki2026vaccine,
  title={Mistral Hallucination Vaccine: Canary-Labeled Self-Healing Dataset},
  author={Funasaki, Hiroto},
  year={2026},
  publisher={Hugging Face},
  url={https://huggingface.co/datasets/hafufu-stack/mistral-hallucination-vaccine}
}
```
